{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Wrap app root render with AuthzProvider via new entry file to fix useAuthzState runtime crash",
  "requirements": [
    {
      "id": "REQ-58",
      "summary": "Ensure the entire React component tree renders within AuthzProvider at the root entry without modifying App.tsx",
      "acceptanceCriteria": [
        "The app no longer shows the runtime error: \"useAuthzState must be used within an AuthzProvider\".",
        "`frontend/src/App.tsx` is not modified.",
        "All routes (public and protected) render without throwing due to missing AuthzProvider."
      ],
      "file_operations": [
        {
          "path": "frontend/src/main.authz.tsx",
          "operation": "modify",
          "description": "Ensure the root-level render wraps the entire application tree with `AuthzProvider` (from the authorization system used by `useAuthzState`) above any components that call `useAuthzState` (e.g., Navbar, route guards, layouts), while keeping the existing provider composition consistent with `frontend/src/main.tsx`. Verify the component's usage instructions before implementing."
        }
      ]
    },
    {
      "id": "REQ-59",
      "summary": "Create a new React entry module that adds AuthzProvider and switch index.html to load it instead of the immutable main.tsx",
      "acceptanceCriteria": [
        "`frontend/index.html` references the new entry module (not `./src/main.tsx`).",
        "The new entry module wraps `<App />` with `<AuthzProvider>` above the router-rendered app content.",
        "Existing root providers already used in `frontend/src/main.tsx` (React Query and Internet Identity providers) remain present and functional in the new entry module.",
        "No changes are made to immutable file `frontend/src/main.tsx`."
      ],
      "file_operations": [
        {
          "path": "frontend/src/main.authz.tsx",
          "operation": "create",
          "description": "Create a new React entry file that mirrors `frontend/src/main.tsx` provider setup (React Query `QueryClientProvider` and `InternetIdentityProvider`) and adds `AuthzProvider` to wrap `<App />` at the root render so no component can render outside it. Verify the component's usage instructions before implementing."
        },
        {
          "path": "frontend/index.html",
          "operation": "modify",
          "description": "Update the module script to load `./src/main.authz.tsx` instead of `./src/main.tsx` so the application boots through the new root-level provider composition."
        }
      ]
    }
  ]
}